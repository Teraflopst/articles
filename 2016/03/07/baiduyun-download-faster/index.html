<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用 aria2 加速百度云下载 · one stark</title><meta name="description" content="使用 aria2 加速百度云下载 - Hewenwei"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/fav.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/fav.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">存档</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">关于</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">使用 aria2 加速百度云下载</h1><div class="post-time">Mar 7, 2016</div><div class="post-content"><blockquote>
<p>aria2 is a lightweight multi-protocol &amp; multi-source command-line download utility. It supports HTTP/HTTPS, FTP, SFTP, BitTorrent and Metalink.</p>
</blockquote>
<p>浏览器默认下载器下载百度云的文件速度大多不理想，非客户端下载限速，大文件下载中途失败，让人体验非常不友好。Windows 平台独享百度云管家下载工具，大文件的上下传速度都比较理想，Mac 平台的同步盘功能少，体验差，直到配合下载工具 <code>aria2</code> 下载速度和大文件下载才有所改善。下面是几步简单的教程。<br><a id="more"></a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>请首先自行安装 <code>Homebrew</code>。Homebrew 安装 <code>aria2</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install aria2</span><br></pre></td></tr></table></figure>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>aria2 有两种常用模式：</p>
<ol>
<li>直接命令行下载 模式</li>
<li>RPC server 模式</li>
</ol>
<p>直接命令行下载模式直接使用命令行进行下载任务，但不推荐使用这种方法。推荐使用  <code>RPC server</code> 模式，这种方式 aria 启动之后只会安静的等待下载请求，下载完成后也只会安静的驻留后台不会自动退出。而使用 RPC 模式推荐做一个配置文件方便使用。</p>
<p>我们把配置文件放在 <code>~/.aria2</code> 文件夹下，依次输入命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~</span><br><span class="line">$ mkdir .aria2</span><br><span class="line">$ <span class="built_in">cd</span> .aria2</span><br><span class="line">$ touch aria2.conf</span><br></pre></td></tr></table></figure>
<p>注意，<code>.aria2</code> 文件夹是隐藏的。可以打开 Finder，利用 <code>Shift + ⌘ + G</code> 进入路径：<code>~/.aria2/aria2.conf</code>，用文本编辑器打开 <code>aria2.conf</code>，参考以下配置修改。建议修改的地方有两处：</p>
<ol>
<li>下载文件保存路径。用户名填写本机当前用户名。</li>
<li>最后一行。如果是 SSD 则不用改，如果是传统硬盘，就改成 <code>file-allocation=prealloc</code>。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#允许rpc</span><br><span class="line">enable-rpc=true</span><br><span class="line">#允许非外部访问</span><br><span class="line">rpc-listen-all=true</span><br><span class="line">#RPC端口, 仅当默认端口被占用时修改</span><br><span class="line">rpc-listen-port=6800</span><br><span class="line"></span><br><span class="line">#最大同时下载数(任务数), 路由建议值: 3</span><br><span class="line">max-concurrent-downloads=10</span><br><span class="line">#断点续传</span><br><span class="line">continue=true</span><br><span class="line">#同服务器连接数</span><br><span class="line">max-connection-per-server=10</span><br><span class="line">#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要</span><br><span class="line">min-split-size=10M</span><br><span class="line">#单文件最大线程数, 路由建议值: 5</span><br><span class="line">split=10</span><br><span class="line">#下载速度限制</span><br><span class="line">max-overall-download-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-download-limit=0</span><br><span class="line">#上传速度限制</span><br><span class="line">max-overall-upload-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-upload-limit=0</span><br><span class="line"></span><br><span class="line">#文件保存路径, 默认为当前启动位置</span><br><span class="line">dir=/Users/用户名/Downloads</span><br><span class="line"></span><br><span class="line">#允许所有来源, web界面跨域权限需要</span><br><span class="line">rpc-allow-origin-all=true</span><br><span class="line"></span><br><span class="line">#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长</span><br><span class="line">#所需时间 none &lt; falloc ? trunc &lt;&lt; prealloc, falloc和trunc需要文件系统和内核支持</span><br><span class="line"># !!仅针对传统磁盘，SSD 降低文件碎片并不是什么好事。</span><br><span class="line">file-allocation=none</span><br></pre></td></tr></table></figure>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h4 id="直接下载"><a href="#直接下载" class="headerlink" title="直接下载"></a>直接下载</h4><p><strong>直接下载</strong> 模式不需要上面的配置文件，使用命令行即可执行任务，当完成后就退出。例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ aria2c http://example.org/mylinux.iso</span><br><span class="line">$ aria2c http://example.org/mylinux.torrent</span><br><span class="line">$ aria2c <span class="string">'magnet:?xt=urn:btih:248D0A1CD08288C...'</span></span><br></pre></td></tr></table></figure>
<p>更多用例，请访问官网 <a href="https://aria2.github.io/" target="_blank" rel="external">Usage Examples</a></p>
<h4 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h4><p><strong>RPC server 模式</strong> 启动后等待从 RPC 接口添加任务，下载完也不退出。每次开机均执行一次命名开启 RPC server 模式即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ aria2c --conf-path=<span class="variable">$&#123;HOME&#125;</span>/.aria2/aria2.conf -D</span><br></pre></td></tr></table></figure>
<p>其中 <code>--conf-path=</code> 后面的路径为你定义的 <code>aria2.conf</code> 配置文件路径。<code>${HOME}</code> 表示 <code>/Users/用户名</code>，<code>-D</code> 为参数，这两处不用修改。</p>
<p>命令执行完后是没有提示的，但这就说明 aria2 启动了。</p>
<p>另外，如果觉得命令不好记忆，亦可以为命令设置别名。打开终端，执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"alias aria2rpc='aria2c --conf-path=<span class="variable">$&#123;HOME&#125;</span>/.aria2/aria2.conf -D'"</span> &gt;&gt; ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>再执行此条命令重载配置令刚才命令生效。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>要查看自定义的 alias 命令，直接在终端中输入 <code>alias</code> 即可查看。</p>
<p>以后需要使用开启 RPC server，只需在 bash 中输入 <code>aria2rpc</code> 即可。如果提示 “command not found”，那么先执行一下上面的 <code>source</code> 命令，再尝试。</p>
<p>使用上面的命令开启 <strong>RPC server 模式</strong> 后，aria 值守后台，再配合图形界面工具使用。</p>
<h4 id="图形界面"><a href="#图形界面" class="headerlink" title="图形界面"></a>图形界面</h4><p>aria2 是一个命令行工具，为了方便，有几种图形界面工具可以配合使用：</p>
<ol>
<li><p>网页 UI<br> 使用网页 UI 需要先开启 RPC server 模式。</p>
<ul>
<li><p>YAAW<br>打开网页 <a href="http://binux.github.io/yaaw/demo/" target="_blank" rel="external">Yet Another Aria2 Web Frontend</a><br>点右上角的扳手按钮，修改 JSON-RPC Path 内容为 <code>http://127.0.0.1:6800/jsonrpc</code>。</p>
</li>
<li><p>另一个网页 UI：<a href="http://ziahamza.github.io/webui-aria2/" target="_blank" rel="external">Aria2 WebUI</a></p>
</li>
</ul>
</li>
<li><p>GUI 客户端<br> 下载 <a href="https://github.com/yangshun1029/aria2gui/releases" target="_blank" rel="external">aria2gui</a>。默认 JSON-RPC 为 <code>http://localhost:6800/jsonrpc</code>，不需要修改。使用时按 <code>+Add</code> 或 <code>+添加</code> 按钮，输入 HTTP、FTP 或 Magnet 进行下载。</p>
</li>
</ol>
<p>如果嫌每次复制粘贴链接麻烦，浏览器有 <code>百度网盘助手</code> 等插件，可以在百度云网页生成 <code>导出下载</code> 按钮，点击 <code>ARIA2 RPC</code> 即可自动在打开的 YAAW 网页或 GUI 客户端上进行下载。aria 还支持迅雷离线、旋风离线、115 网盘等下载，也有相应的浏览器插件。</p>
<ul>
<li><a href="https://chrome.google.com/webstore/detail/baiduexporter/mjaenbjdjmgolhoafkohbhhbaiedbkno" target="_blank" rel="external">Chrome 插件</a></li>
<li><a href="https://raw.githubusercontent.com/acgotaku/BaiduExporter/master/firefox/baidu-exporter.xpi" target="_blank" rel="external">Firefox 插件</a></li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><p><a href="https://aria2.github.io/" target="_blank" rel="external">aria2</a></p>
</li>
<li><p><a href="http://blog.binux.me/2012/12/aria2-examples/" target="_blank" rel="external">aria2 配置示例 - Binuxの杂货铺</a></p>
</li>
<li><p><a href="http://sspai.com/32167" target="_blank" rel="external">Mac 上使用百度网盘很烦躁？花点时间配置 aria2 吧</a></p>
</li>
</ul>
</div></article></div></section><footer><div class="paginator"><a href="/2016/04/07/get-dropbox-external-link/" class="prev">上一篇</a><a href="/2016/01/23/pixels-viewport/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'onestark';
var disqus_identifier = '2016/03/07/baiduyun-download-faster/';
var disqus_title = '使用 aria2 加速百度云下载';
var disqus_url = 'http://yoursite.com/2016/03/07/baiduyun-download-faster/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//onestark.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2016 <a href="http://yoursite.com">Hewenwei</a>, unless otherwise noted.</p></div></footer><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>